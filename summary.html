<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Delivery Summary | MedDrop</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body style="margin:0; background: url('C:/Users/shaku/OneDrive/Documents/medicine/assets/bg.jpg') no-repeat center center fixed; background-size: cover; background-color: #121b40; background-blend-mode: multiply; color: #f5f5f5; min-height: 100vh;">
  <div style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,0.7);z-index:-1;"></div>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg" style="background: linear-gradient(90deg, #1a237ecc, #3949abcc); box-shadow: 0 4px 10px rgba(0,0,0,0.7); padding: 1rem 2rem;">
    <div class="container-fluid" style="max-width: 1200px; margin: auto; display: flex; align-items: center; gap: 1rem;">
      <a class="navbar-brand fw-bold text-uppercase" href="index.html" style="font-size: 1.8rem; letter-spacing: 3px; color: #ff6f00; text-shadow: 1px 1px 5px #000000cc; flex-shrink: 0;">MedDrop</a>

      <a href="index.html" style="
        border-radius: 25px;
        background-color: #3949ab;
        border: none;
        padding: 0.5rem 1.5rem;
        font-weight: 700;
        color: #f5f5f5;
        cursor: pointer;
        transition: background-color 0.3s ease;
        white-space: nowrap;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      "
      onmouseover="this.style.backgroundColor='#283593';"
      onmouseout="this.style.backgroundColor='#3949ab';"
      >Back to Home</a>
    </div>
  </nav>

  <!-- Summary Content -->
  <div class="container py-5" style="max-width: 1200px; margin: 3rem auto; background-color: rgba(18, 27, 64, 0.85); border-radius: 15px; box-shadow: 0 0 30px #000000cc; padding: 2rem 3rem; color: #f5f5f5;">
    <h3 class="mb-4" style="color: #ff6f00; font-weight: 700;">Delivery Request Summary</h3>

    <!-- Filter -->
    <div class="mb-4" style="max-width: 300px;">
      <label for="filterCategory" class="form-label" style="color: #ff6f00; font-weight: 600;">Filter by Category</label>
      <select class="form-select" id="filterCategory" onchange="applyFilters()" style="background-color: #283593; border: none; color: #f5f5f5; border-radius: 25px; font-weight: 600; cursor: pointer;">
        <option value="all" style="color: #121212;">All</option>
        <option value="firstaid" style="color: #121212;">First Aid</option>
        <option value="medication" style="color: #121212;">Medication</option>
        <option value="equipment" style="color: #121212;">Equipment</option>
      </select>
    </div>

    <!-- Table -->
    <div class="table-responsive">
      <table class="table table-striped" style="color: #f5f5f5;">
        <thead class="table-light">
          <tr style="color: #121212;">
            <th>Item</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody id="summaryTableBody">
          <!-- Populated by JS -->
        </tbody>
      </table>
    </div>

    <div class="text-end mt-4">
      <button
        id="checkoutBtn"
        disabled
        style="
          border-radius: 25px;
          background-color: #ff6f00;
          border: none;
          padding: 0.6rem 1.5rem;
          font-weight: 700;
          color: #121212;
          cursor: not-allowed;
          box-shadow: 0 3px 10px #ff6f00cc;
          transition: background-color 0.3s ease;
        "
        onmouseover="if(!this.disabled) this.style.backgroundColor='#e65c00';"
        onmouseout="if(!this.disabled) this.style.backgroundColor='#ff6f00';"
        onclick="proceedToCheckout()"
      >
        Proceed to Checkout
      </button>
    </div>
  </div>

<script>
  function determineCategory(name) {
    const n = name.toLowerCase();
    if (n.includes("kit") || n.includes("wipes") || n.includes("gloves") || n.includes("tape") || n.includes("compress")) {
      return "firstaid";
    } else if (n.includes("pill") || n.includes("sanitizer") || n.includes("thermometer")) {
      return "medication";
    } else {
      return "equipment";
    }
  }

  function loadCartItems() {
    const cart = JSON.parse(localStorage.getItem('deliveryItems')) || [];
    const tbody = document.getElementById('summaryTableBody');
    tbody.innerHTML = '';

    cart.forEach((item, index) => {
      const priceValue = parseFloat(item.price.replace("$", ""));
      const category = determineCategory(item.name);

      const row = document.createElement('tr');
      row.dataset.category = category;

      row.innerHTML = `
        <td>${item.name}</td>
        <td>${item.quantity || 1}</td>
        <td>$${(priceValue * (item.quantity || 1)).toFixed(2)}</td>
        <td><button class="btn btn-sm btn-danger" onclick="removeItem(${index})">Remove</button></td>
      `;
      tbody.appendChild(row);
    });

    toggleCheckoutButton(cart.length > 0);
    applyFilters();
  }

  function removeItem(index) {
    const cart = JSON.parse(localStorage.getItem('deliveryItems')) || [];
    cart.splice(index, 1);
    localStorage.setItem('deliveryItems', JSON.stringify(cart));
    loadCartItems();
  }

  function applyFilters() {
    const search = document.getElementById('searchInput').value.toLowerCase();
    const category = document.getElementById('filterCategory').value;
    const rows = document.querySelectorAll('#summaryTableBody tr');

    rows.forEach(row => {
      const itemName = row.children[0].textContent.toLowerCase();
      const itemCat = row.dataset.category;
      const matchesSearch = itemName.includes(search);
      const matchesCategory = category === 'all' || itemCat === category;
      row.style.display = (matchesSearch && matchesCategory) ? '' : 'none';
    });
  }

  function toggleCheckoutButton(enable) {
    const btn = document.getElementById('checkoutBtn');
    btn.disabled = !enable;
    btn.style.cursor = enable ? 'pointer' : 'not-allowed';
    btn.style.backgroundColor = enable ? '#ff6f00' : '#ccc';
    btn.style.color = enable ? '#121212' : '#666';
    btn.onmouseover = enable
      ? function() { this.style.backgroundColor = '#e65c00'; }
      : null;
    btn.onmouseout = enable
      ? function() { this.style.backgroundColor = '#ff6f00'; }
      : null;
  }

  function proceedToCheckout() {
    const cart = JSON.parse(localStorage.getItem('deliveryItems')) || [];
    if (cart.length > 0) {
      window.location.href = 'checkout.html';
    } else {
      alert('Your cart is empty.');
    }
  }

  window.onload = () => {
    loadCartItems();
  };
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<footer style="
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: rgba(18, 27, 64, 0.85);
  color: #f5f5f5;
  text-align: center;
  padding: 0.75rem 0;
  font-weight: 500;
  font-size: 0.9rem;
  box-shadow: 0 -2px 10px rgba(0,0,0,0.5);
  z-index: 1000;
">
  &copy; 2024 MedDropâ„¢ | Developed by HarshVardhan
</footer>

</body>
</html>
