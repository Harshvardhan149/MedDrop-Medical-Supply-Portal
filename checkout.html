<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout | MedDrop</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body style="
  margin:0;
  background: url('C:/Users/shaku/OneDrive/Documents/medicine/assets/bg.jpg') no-repeat center center fixed;
  background-size: cover;
  background-color: #121b40;
  background-blend-mode: multiply;
  color: #f5f5f5;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
">
  <div style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.7); z-index:-1;"></div>

  <!-- Checkout Form -->
  <div class="container py-5" style="
    max-width: 600px;
    background-color: rgba(18, 27, 64, 0.85);
    border-radius: 15px;
    box-shadow: 0 0 30px #000000cc;
    padding: 2rem 3rem;
  ">
    <h3 class="mb-4" style="color: #ff6f00; font-weight: 700;">Checkout</h3>
    <form id="checkoutForm" onsubmit="submitOrder(event)">
      <div class="mb-4">
        <h5 style="color: #ffb74d; font-weight: 700;">Recipient Details</h5>
        <input type="text" class="form-control mb-3" placeholder="Full Name" required
          style="border-radius: 25px; border: none; padding: 0.6rem 1rem;" />
        <input type="tel" class="form-control mb-3" placeholder="Contact Number" required
          style="border-radius: 25px; border: none; padding: 0.6rem 1rem;" />
        <textarea class="form-control mb-3" placeholder="Delivery Address" rows="3" required
          style="border-radius: 15px; border: none; padding: 0.6rem 1rem;"></textarea>
      </div>

      <div class="mb-4">
        <h5 style="color: #ffb74d; font-weight: 700;">Delivery Options</h5>
        <select id="deliveryMethod" class="form-select mb-4" required
          style="border-radius: 25px; border: none; padding: 0.6rem 1rem; background-color: #283593; color: #f5f5f5;">
          <option value="" selected disabled>Choose delivery method</option>
          <option value="0">Standard (Free)</option>
          <option value="5">Express (+$5.00)</option>
          <option value="2">Eco-Friendly (+$2.00)</option>
        </select>
      </div>

      <div class="mb-4">
        <h5 style="color: #ffb74d; font-weight: 700;">Order Summary</h5>
        <ul class="list-group mb-3" id="order-summary" style="border-radius: 15px; overflow: hidden;">
          <!-- Dynamic Items -->
        </ul>
        <div class="fw-bold text-end" style="color: #ff6f00; font-size: 1.25rem;">
          Total: $<span id="summary-total">0.00</span>
        </div>
      </div>

      <!-- Buttons -->
      <div class="d-flex justify-content-between align-items-center mt-4">
        <a href="index.html" style="
          border-radius: 25px;
          background-color: #3949ab;
          border: none;
          padding: 0.6rem 1.5rem;
          font-weight: 700;
          color: #f5f5f5;
          cursor: pointer;
          transition: background-color 0.3s ease;
          text-decoration: none;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          white-space: nowrap;
        "
        onmouseover="this.style.backgroundColor='#283593';"
        onmouseout="this.style.backgroundColor='#3949ab';"
        >Back to Home</a>

        <a href="summary.html" style="
          border-radius: 25px;
          background-color: #ff6f00;
          border: none;
          padding: 0.6rem 1.5rem;
          font-weight: 700;
          color: #121212;
          cursor: pointer;
          transition: background-color 0.3s ease;
          text-decoration: none;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          white-space: nowrap;
          margin-right: 1rem;
        "
        onmouseover="this.style.backgroundColor='#e65c00';"
        onmouseout="this.style.backgroundColor='#ff6f00';"
        >View Summary</a>

        <button id="placeOrderBtn" type="submit" class="btn btn-success" style="
          border-radius: 25px;
          padding: 0.6rem 1.5rem;
          font-weight: 700;
          box-shadow: 0 3px 10px #2e7d32cc;
          cursor: not-allowed;
        " disabled>Place Order</button>
      </div>
    </form>
  </div>

<script>
const deliveryMethod = document.getElementById('deliveryMethod');
const placeOrderBtn = document.getElementById('placeOrderBtn');
const summaryTotalSpan = document.getElementById('summary-total');

function submitOrder(event) {
  event.preventDefault();
  if (!deliveryMethod.value) {
    alert('Please select a delivery method before placing your order.');
    return;
  }
  alert('Order submitted successfully!');
  localStorage.removeItem('deliveryItems');
  location.href = 'index.html';
}

function loadSummary() {
  const items = JSON.parse(localStorage.getItem('deliveryItems') || '[]');
  const list = document.getElementById('order-summary');
  list.innerHTML = '';
  let total = 0;

  items.forEach(item => {
    const price = parseFloat(item.price.replace("$", "")) * (item.quantity || 1);
    const li = document.createElement('li');
    li.className = 'list-group-item d-flex justify-content-between';
    li.style.backgroundColor = '#3949ab';
    li.style.color = '#f5f5f5';
    li.style.border = 'none';
    li.style.borderRadius = '0';
    li.style.padding = '0.75rem 1.25rem';
    li.innerHTML = `<span>${item.name} x${item.quantity || 1}</span><span>$${price.toFixed(2)}</span>`;
    list.appendChild(li);
    total += price;
  });

  updateTotal(total);
}

function updateTotal(itemsTotal) {
  const surcharge = parseFloat(deliveryMethod.value) || 0;
  const newTotal = itemsTotal + surcharge;
  summaryTotalSpan.textContent = newTotal.toFixed(2);
}

// Enable place order button only if delivery method selected
deliveryMethod.addEventListener('change', () => {
  placeOrderBtn.disabled = !deliveryMethod.value;
  placeOrderBtn.style.cursor = deliveryMethod.value ? 'pointer' : 'not-allowed';
  loadSummary(); // Recalculate total with new delivery surcharge
});

// Initial load
window.onload = () => {
  loadSummary();
  placeOrderBtn.disabled = true;
  placeOrderBtn.style.cursor = 'not-allowed';
};
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<footer style="
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: rgba(18, 27, 64, 0.85);
  color: #f5f5f5;
  text-align: center;
  padding: 0.75rem 0;
  font-weight: 500;
  font-size: 0.9rem;
  box-shadow: 0 -2px 10px rgba(0,0,0,0.5);
  z-index: 1000;
">
  &copy; 2024 MedDropâ„¢ | Developed by HarshVardhan
</footer>

</body>
</html>
